
> doc-flow-web@0.1.0 test
> vitest


[1m[44m DEV [49m[22m [34mv4.0.18 [39m[90mC:/Development/doc-flow/doc-flow-web[39m

 [31mÃ”Ã˜Â»[39m __tests__/unit/extraction-service.test.ts [2m([22m[2m5 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[32m 6[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should extract simple code pattern[39m[32m 4[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should extract code with revision[39m[32m 0[2mms[22m[39m
       [32mÃ”Â£Ã´[39m should return undefined if no pattern matches[32m 0[2mms[22m[39m
       [32mÃ”Â£Ã´[39m should return 1 for identical strings[32m 0[2mms[22m[39m
       [32mÃ”Â£Ã´[39m should return high score for minor differences[32m 0[2mms[22m[39m
 [32mÃ”Â£Ã´[39m __tests__/unit/validation-service.test.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 3[2mms[22m[39m
 [32mÃ”Â£Ã´[39m __tests__/unit/batch-service.test.ts [2m([22m[2m2 tests[22m[2m)[22m[32m 4[2mms[22m[39m
 [31mÃ”Ã˜Â»[39m __tests__/unit/resolution-service.test.ts [2m([22m[2m2 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 5[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should return candidates ordered by similarity[39m[32m 3[2mms[22m[39m
       [32mÃ”Â£Ã´[39m should exist[32m 0[2mms[22m[39m
 [32mÃ”Â£Ã´[39m __tests__/components/create-batch-dialog.test.tsx [2m([22m[2m3 tests[22m[2m)[22m[32m 223[2mms[22m[39m
 [31mÃ”Ã˜Â»[39m e2e/validation-flow.spec.ts [2m([22m[2m0 test[22m[2m)[22m

Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â» Failed Suites 1 Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»

 FAIL  e2e/validation-flow.spec.ts [ e2e/validation-flow.spec.ts ]
Error: Playwright Test did not expect test.describe() to be called here.
Most common reasons include:
- You are calling test.describe() in a configuration file.
- You are calling test.describe() in a file that is imported by the configuration file.
- You have two different versions of @playwright/test. This usually happens
  when one of the dependencies in your package.json depends on @playwright/test.
 Ã”Ã˜Â» TestTypeImpl._currentSuite node_modules/playwright/lib/common/testType.js:75:13
 Ã”Ã˜Â» TestTypeImpl._describe node_modules/playwright/lib/common/testType.js:115:24
 Ã”Ã˜Â» Function.describe node_modules/playwright/lib/transform/transform.js:282:12
 Ã”Ã˜Â» e2e/validation-flow.spec.ts:4:6
      2| import path from 'path';
      3| 
      4| test.describe('Validation Flow', () => {
       |      ^
      5|     test.beforeEach(async ({ page }) => {
      6|         // As we don't have a real auth setup in this test env yet, 

Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»[1/4]Ã”Ã„Â»


Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â» Failed Tests 3 Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»

 FAIL  __tests__/unit/extraction-service.test.ts > ExtractionService > extractDocumentCode > should extract simple code pattern
TypeError: Cannot read properties of undefined (reading 'toUpperCase')
 Ã”Ã˜Â» ExtractionService.extractDocumentCode lib/validator/services/extraction-service.ts:194:33
    192|             const match = filename.match(pattern);
    193|             if (match) {
    194|                 return match[1].toUpperCase();
       |                                 ^
    195|             }
    196|         }
 Ã”Ã˜Â» __tests__/unit/extraction-service.test.ts:10:34

Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»[2/4]Ã”Ã„Â»

 FAIL  __tests__/unit/extraction-service.test.ts > ExtractionService > extractDocumentCode > should extract code with revision
TypeError: Cannot read properties of undefined (reading 'toUpperCase')
 Ã”Ã˜Â» ExtractionService.extractDocumentCode lib/validator/services/extraction-service.ts:194:33
    192|             const match = filename.match(pattern);
    193|             if (match) {
    194|                 return match[1].toUpperCase();
       |                                 ^
    195|             }
    196|         }
 Ã”Ã˜Â» __tests__/unit/extraction-service.test.ts:15:34

Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»[3/4]Ã”Ã„Â»

 FAIL  __tests__/unit/resolution-service.test.ts > ResolutionService > getCandidates > should return candidates ordered by similarity
TypeError: Cannot read properties of undefined (reading 'select')
 Ã”Ã˜Â» ResolutionService.getCandidates lib/validator/services/resolution-service.ts:118:40
    116|         // Buscar documento para sugestâ”œÃes smart (comportamento originÃ”Ã‡Âª
    117|         const { data: doc } = await supabase
    118|             .from('validated_documents')
       |                                        ^
    119|             .select('*')
    120|             .eq('id', documentId)
 Ã”Ã˜Â» __tests__/unit/resolution-service.test.ts:38:32

Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»[4/4]Ã”Ã„Â»


[2m Test Files [22m [1m[31m3 failed[39m[22m[2m | [22m[1m[32m3 passed[39m[22m[90m (6)[39m
[2m      Tests [22m [1m[31m3 failed[39m[22m[2m | [22m[1m[32m13 passed[39m[22m[90m (16)[39m
[2m   Start at [22m 09:58:00
[2m   Duration [22m 11.66s[2m (transform 1.33s, setup 5.39s, import 2.57s, tests 241ms, environment 13.99s)[22m

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mlib/validator/services/extraction-service.ts [22m[39m

 [31mÃ”Ã˜Â»[39m e2e/validation-flow.spec.ts [2m([22m[2m0 test[22m[2m)[22m
 [31mÃ”Ã˜Â»[39m __tests__/unit/extraction-service.test.ts [2m([22m[2m5 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[32m 9[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should extract simple code pattern[39m[32m 5[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should extract code with revision[39m[32m 1[2mms[22m[39m
       [32mÃ”Â£Ã´[39m should return undefined if no pattern matches[32m 1[2mms[22m[39m
       [32mÃ”Â£Ã´[39m should return 1 for identical strings[32m 0[2mms[22m[39m
       [32mÃ”Â£Ã´[39m should return high score for minor differences[32m 0[2mms[22m[39m
 [32mÃ”Â£Ã´[39m __tests__/unit/validation-service.test.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 5[2mms[22m[39m
 [31mÃ”Ã˜Â»[39m __tests__/unit/resolution-service.test.ts [2m([22m[2m2 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 8[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should return candidates ordered by similarity[39m[32m 6[2mms[22m[39m
       [32mÃ”Â£Ã´[39m should exist[32m 1[2mms[22m[39m

Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â» Failed Tests 3 Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»

 FAIL  __tests__/unit/extraction-service.test.ts > ExtractionService > extractDocumentCode > should extract simple code pattern
TypeError: Cannot read properties of undefined (reading 'toUpperCase')
 Ã”Ã˜Â» ExtractionService.extractDocumentCode lib/validator/services/extraction-service.ts:194:33
    192|             const match = filename.match(pattern);
    193|             if (match) {
    194|                 return match[1].toUpperCase();
       |                                 ^
    195|             }
    196|         }
 Ã”Ã˜Â» __tests__/unit/extraction-service.test.ts:10:34

Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»[1/3]Ã”Ã„Â»

 FAIL  __tests__/unit/extraction-service.test.ts > ExtractionService > extractDocumentCode > should extract code with revision
TypeError: Cannot read properties of undefined (reading 'toUpperCase')
 Ã”Ã˜Â» ExtractionService.extractDocumentCode lib/validator/services/extraction-service.ts:194:33
    192|             const match = filename.match(pattern);
    193|             if (match) {
    194|                 return match[1].toUpperCase();
       |                                 ^
    195|             }
    196|         }
 Ã”Ã˜Â» __tests__/unit/extraction-service.test.ts:15:34

Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»[2/3]Ã”Ã„Â»

 FAIL  __tests__/unit/resolution-service.test.ts > ResolutionService > getCandidates > should return candidates ordered by similarity
TypeError: Cannot read properties of undefined (reading 'select')
 Ã”Ã˜Â» ResolutionService.getCandidates lib/validator/services/resolution-service.ts:118:40
    116|         // Buscar documento para sugestâ”œÃes smart (comportamento originÃ”Ã‡Âª
    117|         const { data: doc } = await supabase
    118|             .from('validated_documents')
       |                                        ^
    119|             .select('*')
    120|             .eq('id', documentId)
 Ã”Ã˜Â» __tests__/unit/resolution-service.test.ts:38:32

Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»[3/3]Ã”Ã„Â»


[2m Test Files [22m [1m[31m3 failed[39m[22m[2m | [22m[1m[32m1 passed[39m[22m[90m (4)[39m
[2m      Tests [22m [1m[31m3 failed[39m[22m[2m | [22m[1m[32m8 passed[39m[22m[90m (11)[39m
[2m   Start at [22m 09:58:19
[2m   Duration [22m 3.28s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mlib/validator/services/extraction-service.ts [22m[39m

 [31mÃ”Ã˜Â»[39m e2e/validation-flow.spec.ts [2m([22m[2m0 test[22m[2m)[22m
 [31mÃ”Ã˜Â»[39m __tests__/unit/extraction-service.test.ts [2m([22m[2m5 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[32m 8[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should extract simple code pattern[39m[32m 4[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should extract code with revision[39m[32m 1[2mms[22m[39m
       [32mÃ”Â£Ã´[39m should return undefined if no pattern matches[32m 1[2mms[22m[39m
       [32mÃ”Â£Ã´[39m should return 1 for identical strings[32m 0[2mms[22m[39m
       [32mÃ”Â£Ã´[39m should return high score for minor differences[32m 0[2mms[22m[39m
 [32mÃ”Â£Ã´[39m __tests__/unit/validation-service.test.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 3[2mms[22m[39m
 [31mÃ”Ã˜Â»[39m __tests__/unit/resolution-service.test.ts [2m([22m[2m2 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 5[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should return candidates ordered by similarity[39m[32m 4[2mms[22m[39m
       [32mÃ”Â£Ã´[39m should exist[32m 0[2mms[22m[39m

Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â» Failed Tests 3 Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»

 FAIL  __tests__/unit/extraction-service.test.ts > ExtractionService > extractDocumentCode > should extract simple code pattern
TypeError: Cannot read properties of undefined (reading 'toUpperCase')
 Ã”Ã˜Â» ExtractionService.extractDocumentCode lib/validator/services/extraction-service.ts:194:33
    192|             const match = filename.match(pattern);
    193|             if (match) {
    194|                 return match[1].toUpperCase();
       |                                 ^
    195|             }
    196|         }
 Ã”Ã˜Â» __tests__/unit/extraction-service.test.ts:10:34

Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»[1/3]Ã”Ã„Â»

 FAIL  __tests__/unit/extraction-service.test.ts > ExtractionService > extractDocumentCode > should extract code with revision
TypeError: Cannot read properties of undefined (reading 'toUpperCase')
 Ã”Ã˜Â» ExtractionService.extractDocumentCode lib/validator/services/extraction-service.ts:194:33
    192|             const match = filename.match(pattern);
    193|             if (match) {
    194|                 return match[1].toUpperCase();
       |                                 ^
    195|             }
    196|         }
 Ã”Ã˜Â» __tests__/unit/extraction-service.test.ts:15:34

Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»[2/3]Ã”Ã„Â»

 FAIL  __tests__/unit/resolution-service.test.ts > ResolutionService > getCandidates > should return candidates ordered by similarity
TypeError: Cannot read properties of undefined (reading 'select')
 Ã”Ã˜Â» ResolutionService.getCandidates lib/validator/services/resolution-service.ts:118:40
    116|         // Buscar documento para sugestâ”œÃes smart (comportamento originÃ”Ã‡Âª
    117|         const { data: doc } = await supabase
    118|             .from('validated_documents')
       |                                        ^
    119|             .select('*')
    120|             .eq('id', documentId)
 Ã”Ã˜Â» __tests__/unit/resolution-service.test.ts:38:32

Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»[3/3]Ã”Ã„Â»


[2m Test Files [22m [1m[31m3 failed[39m[22m[2m | [22m[1m[32m1 passed[39m[22m[90m (4)[39m
[2m      Tests [22m [1m[31m3 failed[39m[22m[2m | [22m[1m[32m8 passed[39m[22m[90m (11)[39m
[2m   Start at [22m 09:58:25
[2m   Duration [22m 3.68s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mlib/validator/services/extraction-service.ts [22m[39m

 [31mÃ”Ã˜Â»[39m e2e/validation-flow.spec.ts [2m([22m[2m0 test[22m[2m)[22m
 [32mÃ”Â£Ã´[39m __tests__/unit/validation-service.test.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 3[2mms[22m[39m
 [31mÃ”Ã˜Â»[39m __tests__/unit/extraction-service.test.ts [2m([22m[2m5 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[32m 6[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should extract simple code pattern[39m[32m 3[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should extract code with revision[39m[32m 0[2mms[22m[39m
       [32mÃ”Â£Ã´[39m should return undefined if no pattern matches[32m 0[2mms[22m[39m
       [32mÃ”Â£Ã´[39m should return 1 for identical strings[32m 0[2mms[22m[39m
       [32mÃ”Â£Ã´[39m should return high score for minor differences[32m 0[2mms[22m[39m
 [31mÃ”Ã˜Â»[39m __tests__/unit/resolution-service.test.ts [2m([22m[2m2 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 5[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should return candidates ordered by similarity[39m[32m 3[2mms[22m[39m
       [32mÃ”Â£Ã´[39m should exist[32m 0[2mms[22m[39m

Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â» Failed Tests 3 Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»

 FAIL  __tests__/unit/extraction-service.test.ts > ExtractionService > extractDocumentCode > should extract simple code pattern
TypeError: Cannot read properties of undefined (reading 'toUpperCase')
 Ã”Ã˜Â» ExtractionService.extractDocumentCode lib/validator/services/extraction-service.ts:194:33
    192|             const match = filename.match(pattern);
    193|             if (match) {
    194|                 return match[1].toUpperCase();
       |                                 ^
    195|             }
    196|         }
 Ã”Ã˜Â» __tests__/unit/extraction-service.test.ts:10:34

Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»[1/3]Ã”Ã„Â»

 FAIL  __tests__/unit/extraction-service.test.ts > ExtractionService > extractDocumentCode > should extract code with revision
TypeError: Cannot read properties of undefined (reading 'toUpperCase')
 Ã”Ã˜Â» ExtractionService.extractDocumentCode lib/validator/services/extraction-service.ts:194:33
    192|             const match = filename.match(pattern);
    193|             if (match) {
    194|                 return match[1].toUpperCase();
       |                                 ^
    195|             }
    196|         }
 Ã”Ã˜Â» __tests__/unit/extraction-service.test.ts:15:34

Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»[2/3]Ã”Ã„Â»

 FAIL  __tests__/unit/resolution-service.test.ts > ResolutionService > getCandidates > should return candidates ordered by similarity
TypeError: supabase.from(...).select(...).eq(...).single is not a function
 Ã”Ã˜Â» ResolutionService.getCandidates lib/validator/services/resolution-service.ts:121:14
    119|             .select('*')
    120|             .eq('id', documentId)
    121|             .single();
       |              ^
    122| 
    123|         if (!doc) {
 Ã”Ã˜Â» __tests__/unit/resolution-service.test.ts:41:32

Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»[3/3]Ã”Ã„Â»


[2m Test Files [22m [1m[31m3 failed[39m[22m[2m | [22m[1m[32m1 passed[39m[22m[90m (4)[39m
[2m      Tests [22m [1m[31m3 failed[39m[22m[2m | [22m[1m[32m8 passed[39m[22m[90m (11)[39m
[2m   Start at [22m 10:00:00
[2m   Duration [22m 3.21s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2m__tests__/unit/resolution-service.test.ts [22m[34mx4 [34m[39m

 [31mÃ”Ã˜Â»[39m e2e/validation-flow.spec.ts [2m([22m[2m0 test[22m[2m)[22m
 [31mÃ”Ã˜Â»[39m __tests__/unit/extraction-service.test.ts [2m([22m[2m5 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[32m 6[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should extract simple code pattern[39m[32m 3[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should extract code with revision[39m[32m 0[2mms[22m[39m
       [32mÃ”Â£Ã´[39m should return undefined if no pattern matches[32m 0[2mms[22m[39m
       [32mÃ”Â£Ã´[39m should return 1 for identical strings[32m 0[2mms[22m[39m
       [32mÃ”Â£Ã´[39m should return high score for minor differences[32m 0[2mms[22m[39m
 [31mÃ”Ã˜Â»[39m __tests__/unit/resolution-service.test.ts [2m([22m[2m2 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 4[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should return candidates ordered by similarity[39m[32m 3[2mms[22m[39m
       [32mÃ”Â£Ã´[39m should exist[32m 0[2mms[22m[39m

Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â» Failed Tests 1 Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»

 FAIL  __tests__/unit/resolution-service.test.ts > ResolutionService > getCandidates > should return candidates ordered by similarity
TypeError: supabase.from(...).select(...).eq(...).single is not a function
 Ã”Ã˜Â» ResolutionService.getCandidates lib/validator/services/resolution-service.ts:121:14
    119|             .select('*')
    120|             .eq('id', documentId)
    121|             .single();
       |              ^
    122| 
    123|         if (!doc) {
 Ã”Ã˜Â» __tests__/unit/resolution-service.test.ts:41:32

Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»[1/1]Ã”Ã„Â»


[2m Test Files [22m [1m[31m3 failed[39m[22m[90m (3)[39m
[2m      Tests [22m [1m[31m3 failed[39m[22m[2m | [22m[1m[32m4 passed[39m[22m[90m (7)[39m
[2m   Start at [22m 10:00:05
[2m   Duration [22m 925ms

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
^C
