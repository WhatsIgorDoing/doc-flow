============================= test session starts =============================
platform win32 -- Python 3.11.3, pytest-7.4.4, pluggy-1.6.0
rootdir: C:\Development\doc-flow
plugins: anyio-4.12.0, asyncio-0.23.3, cov-7.0.0, mock-3.15.1, timeout-2.4.0
asyncio: mode=Mode.STRICT
collected 3 items

tests\unit\infrastructure\test_database.py EEE                           [100%]

=================================== ERRORS ====================================
___________ ERROR at setup of test_save_and_get_validated_documents ___________

tmp_path = WindowsPath('C:/Users/igor.bueno/AppData/Local/Temp/pytest-of-igor.bueno/pytest-33/test_save_and_get_validated_do0')

    @pytest.fixture
    def db_manager(tmp_path):
        # Sobrescreve database path para usar arquivo temporario ou memoria
        # Mas como DatabaseManager usa settings singleton, vamos usar :memory: se possivel
        # ou monkeypatch settings.
    
        from app.core.config import settings
>       original_db_name = settings.DATABASE_NAME

tests\unit\infrastructure\test_database.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = Settings(APP_NAME='SAD_Validator', APP_VERSION='2.0.0', ENVIRONMENT='development', DEBUG=False, SECRET_KEY='03jnMMygCp...=3, SYNC_ENABLED=True, LOG_LEVEL='INFO', LOG_PATH='./logs', LOG_FORMAT='json', HOST='0.0.0.0', PORT=8080, RELOAD=False)
item = 'DATABASE_NAME'

    def __getattr__(self, item: str) -> Any:
        private_attributes = object.__getattribute__(self, '__private_attributes__')
        if item in private_attributes:
            attribute = private_attributes[item]
            if hasattr(attribute, '__get__'):
                return attribute.__get__(self, type(self))  # type: ignore
    
            try:
                # Note: self.__pydantic_private__ cannot be None if self.__private_attributes__ has items
                return self.__pydantic_private__[item]  # type: ignore
            except KeyError as exc:
                raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}') from exc
        else:
            # `__pydantic_extra__` can fail to be set if the model is not yet fully initialized.
            # See `BaseModel.__repr_args__` for more details
            try:
                pydantic_extra = object.__getattribute__(self, '__pydantic_extra__')
            except AttributeError:
                pydantic_extra = None
    
            if pydantic_extra is not None:
                try:
                    return pydantic_extra[item]
                except KeyError as exc:
                    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}') from exc
            else:
                if hasattr(self.__class__, item):
                    return super().__getattribute__(item)  # Raises AttributeError if appropriate
                else:
                    # this is the current error
>                   raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
E                   AttributeError: 'Settings' object has no attribute 'DATABASE_NAME'

C:\Users\igor.bueno\AppData\Roaming\Python\Python311\site-packages\pydantic\main.py:761: AttributeError
______________ ERROR at setup of test_clear_validated_documents _______________

tmp_path = WindowsPath('C:/Users/igor.bueno/AppData/Local/Temp/pytest-of-igor.bueno/pytest-33/test_clear_validated_documents0')

    @pytest.fixture
    def db_manager(tmp_path):
        # Sobrescreve database path para usar arquivo temporario ou memoria
        # Mas como DatabaseManager usa settings singleton, vamos usar :memory: se possivel
        # ou monkeypatch settings.
    
        from app.core.config import settings
>       original_db_name = settings.DATABASE_NAME

tests\unit\infrastructure\test_database.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = Settings(APP_NAME='SAD_Validator', APP_VERSION='2.0.0', ENVIRONMENT='development', DEBUG=False, SECRET_KEY='03jnMMygCp...=3, SYNC_ENABLED=True, LOG_LEVEL='INFO', LOG_PATH='./logs', LOG_FORMAT='json', HOST='0.0.0.0', PORT=8080, RELOAD=False)
item = 'DATABASE_NAME'

    def __getattr__(self, item: str) -> Any:
        private_attributes = object.__getattribute__(self, '__private_attributes__')
        if item in private_attributes:
            attribute = private_attributes[item]
            if hasattr(attribute, '__get__'):
                return attribute.__get__(self, type(self))  # type: ignore
    
            try:
                # Note: self.__pydantic_private__ cannot be None if self.__private_attributes__ has items
                return self.__pydantic_private__[item]  # type: ignore
            except KeyError as exc:
                raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}') from exc
        else:
            # `__pydantic_extra__` can fail to be set if the model is not yet fully initialized.
            # See `BaseModel.__repr_args__` for more details
            try:
                pydantic_extra = object.__getattribute__(self, '__pydantic_extra__')
            except AttributeError:
                pydantic_extra = None
    
            if pydantic_extra is not None:
                try:
                    return pydantic_extra[item]
                except KeyError as exc:
                    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}') from exc
            else:
                if hasattr(self.__class__, item):
                    return super().__getattribute__(item)  # Raises AttributeError if appropriate
                else:
                    # this is the current error
>                   raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
E                   AttributeError: 'Settings' object has no attribute 'DATABASE_NAME'

C:\Users\igor.bueno\AppData\Roaming\Python\Python311\site-packages\pydantic\main.py:761: AttributeError
________ ERROR at setup of test_save_overwrites_previous_session_data _________

tmp_path = WindowsPath('C:/Users/igor.bueno/AppData/Local/Temp/pytest-of-igor.bueno/pytest-33/test_save_overwrites_previous_0')

    @pytest.fixture
    def db_manager(tmp_path):
        # Sobrescreve database path para usar arquivo temporario ou memoria
        # Mas como DatabaseManager usa settings singleton, vamos usar :memory: se possivel
        # ou monkeypatch settings.
    
        from app.core.config import settings
>       original_db_name = settings.DATABASE_NAME

tests\unit\infrastructure\test_database.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = Settings(APP_NAME='SAD_Validator', APP_VERSION='2.0.0', ENVIRONMENT='development', DEBUG=False, SECRET_KEY='03jnMMygCp...=3, SYNC_ENABLED=True, LOG_LEVEL='INFO', LOG_PATH='./logs', LOG_FORMAT='json', HOST='0.0.0.0', PORT=8080, RELOAD=False)
item = 'DATABASE_NAME'

    def __getattr__(self, item: str) -> Any:
        private_attributes = object.__getattribute__(self, '__private_attributes__')
        if item in private_attributes:
            attribute = private_attributes[item]
            if hasattr(attribute, '__get__'):
                return attribute.__get__(self, type(self))  # type: ignore
    
            try:
                # Note: self.__pydantic_private__ cannot be None if self.__private_attributes__ has items
                return self.__pydantic_private__[item]  # type: ignore
            except KeyError as exc:
                raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}') from exc
        else:
            # `__pydantic_extra__` can fail to be set if the model is not yet fully initialized.
            # See `BaseModel.__repr_args__` for more details
            try:
                pydantic_extra = object.__getattribute__(self, '__pydantic_extra__')
            except AttributeError:
                pydantic_extra = None
    
            if pydantic_extra is not None:
                try:
                    return pydantic_extra[item]
                except KeyError as exc:
                    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}') from exc
            else:
                if hasattr(self.__class__, item):
                    return super().__getattribute__(item)  # Raises AttributeError if appropriate
                else:
                    # this is the current error
>                   raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
E                   AttributeError: 'Settings' object has no attribute 'DATABASE_NAME'

C:\Users\igor.bueno\AppData\Roaming\Python\Python311\site-packages\pydantic\main.py:761: AttributeError
=========================== short test summary info ===========================
ERROR tests/unit/infrastructure/test_database.py::test_save_and_get_validated_documents
ERROR tests/unit/infrastructure/test_database.py::test_clear_validated_documents
ERROR tests/unit/infrastructure/test_database.py::test_save_overwrites_previous_session_data
============================== 3 errors in 1.25s ==============================
